# React Ecosystem 

## Notes

## TanStack Router
- TanStack Router is a powerful routing library for React applications. It provides type-safe routing, automatic code splitting, and a great developer experience.

### Configuration
- We updated `vite.config.js` to include the TanStack Router plugin. This plugin automatically generates the route tree based on the file structure in the `src/routes` directory.
- The generated route tree is stored in `src/routeTree.gen.ts`. We should not edit this file manually.

### Setting up the Router
- In `src/App.jsx`, we replaced the manual component rendering with `RouterProvider`.
- We create a router instance using `createRouter` and pass the generated `routeTree`.
- We wrap the `RouterProvider` with `StrictMode` (optional but recommended).

### Creating Routes
- We created a `src/routes` directory to house our route components.
- **Root Route (`__root.jsx`)**: This is the main layout component that wraps all other routes. It's where we put global providers (like `CartContext`) and layout elements (like `Header` and `TanStackRouterDevtools`). It renders an `<Outlet />` where child routes will be displayed.
- **File-based Routing**: We use a naming convention like `index.lazy.jsx` for the home page and `order.lazy.jsx` for the order page. The `.lazy.jsx` extension indicates that these routes should be code-split and loaded lazily.

### Navigation
- We use the `<Link>` component from `@tanstack/react-router` for navigation.
- In `src/Header.jsx`, we wrapped the logo with a `<Link to="/">` to navigate back to the home page.

### DevTools
- We included `TanStackRouterDevtools` in our root route. This provides a visual interface to inspect the router state, current route, and more during development. It's automatically removed in production builds.

## TanStack Query

- TanStack Query (formerly React Query) is a powerful data fetching and state management library. It handles caching, background updates, and stale data management.

### Configuration
- In `src/App.jsx`, we set up the `QueryClient` and wrapped our app with `QueryClientProvider`. This makes the query client available to all components.
- We also added `ReactQueryDevtools` to `src/routes/__root.jsx` to visualize the query cache and status during development.
- We updated `eslint.config.mjs` to include the recommended ESLint rules for TanStack Query.

### Fetching Data
- We created a new API function `src/api/getPastOrders.js` to fetch past orders from the backend.
- In `src/routes/past.lazy.jsx`, we used the `useQuery` hook to fetch data.
  - **`queryKey`**: An array that uniquely identifies the query. We included `page` in the key so that the query refetches when the page changes (e.g., `["past-orders", page]`).
  - **`queryFn`**: The function that actually fetches the data.
  - **`staleTime`**: We set `staleTime: 30000` (30 seconds). This means the data is considered fresh for 30 seconds. If the user navigates away and comes back within that time, the cached data will be used without a background refetch.

### Pagination
- We implemented simple pagination in `src/routes/past.lazy.jsx` by managing a `page` state.
- The `useQuery` hook automatically handles refetching when the `page` state changes because `page` is part of the `queryKey`.
